<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Perform a _p_-curve analysis</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table width="100%" summary="page for pcurve {dmetar}"><tr><td>pcurve {dmetar}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Perform a <em>p</em>-curve analysis</h2>

<h3>Description</h3>

<p>This function performs a <i>p</i>-curve analysis using a <code>meta</code> object or calculated effect size data.
</p>


<h3>Usage</h3>

<pre>
pcurve(x, effect.estimation = FALSE, N, dmin = 0, dmax = 1)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>Either an object of class <code>meta</code>, generated by the <code>metagen</code>, <code>metacont</code>,
<code>metacor</code>, <code>metainc</code>, or <code>metabin</code> function, or a dataframe containing the calculated effect size
(named <code>TE</code>, log-transformed if based on a ratio), standard error (named <code>seTE</code>) and study label (named <code>studlab</code>)
for each study.</p>
</td></tr>
<tr valign="top"><td><code>effect.estimation</code></td>
<td>
<p>Logical. Should the true effect size underlying the <em>p</em>-curve be estimated?
If set to <code>TRUE</code>, a vector containing the total sample size for each study must be provided for
<code>N</code>. <code>FALSE</code> by default.</p>
</td></tr>
<tr valign="top"><td><code>N</code></td>
<td>
<p>A numeric vector of same length as the number of effect sizes included in <code>x</code> specifying the
total sample size <i>N</i> corresponding to each effect. Only needed if <code>effect.estimation = TRUE</code>.</p>
</td></tr>
<tr valign="top"><td><code>dmin</code></td>
<td>
<p>If <code>effect.estimation = TRUE</code>: lower limit for the effect size (<i>d</i>) space in which
the true effect size should be searched. Must be greater or equal to 0. Default is 0.</p>
</td></tr>
<tr valign="top"><td><code>dmax</code></td>
<td>
<p>If <code>effect.estimation = TRUE</code>: upper limit for the effect size (<i>d</i>) space in which
the true effect size should be searched. Must be greater than 0. Default is 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>P-curve Analysis</strong>
</p>
<p><i>P</i>-curve analysis (Simonsohn, Simmons &amp; Nelson, 2014, 2015) has been proposed as a method
to detect <i>p</i>-hacking and publication bias in meta-analyses.
</p>
<p><i>P</i>-Curve assumes that publication bias
is not only generated because researchers do not publish non-significant results,
but also because analysts “play” around with their data (&quot;<i>p</i>-hacking&quot;; e.g., selectively removing outliers,
choosing different outcomes, controlling for different variables) until a non-significant
finding becomes significant (i.e., <i>p&lt;0.05</i>).
</p>
<p>The method assumes that for a specific research
question, <i>p</i>-values smaller 0.05 of included studies should follow a right-skewed distribution
if a true effect exists, even when the power in single studies was (relatively) low. Conversely,
a left-skewed <i>p</i>-value distribution indicates the presence of <i>p</i>-hacking and absence of
a true underlying effect. To control for &quot;ambitious&quot; <i>p</i>-hacking, <i>P</i>-curve also incorporates a
&quot;half-curve&quot; test (Simonsohn, Simmons &amp; Nelson, 2014, 2015).
</p>
<p>Simonsohn et al. (2014)
stress that <i>p</i>-curve analysis should only be used for test statistics which were actually of interest
in the context of the included study, and that a detailed table documenting the reported results
used in for the <i>p</i>-curve analysis should be created before communicating
results (<a href="http://www.p-curve.com/Supplement/">link</a>).
</p>
<p><strong>Implementation in the function</strong>
</p>
<p>To generate the <i>p</i>-curve and conduct the analysis, this function reuses parts of the <em>R</em> code underlying
the <a href="http://p-curve.com/app4/pcurve_app4.052.r">P-curve App 4.052</a> (Simonsohn, 2017). The effect sizes
included in the <code>meta</code> object or <code>data.frame</code> provided for <code>x</code> are transformed
into <i>z</i>-values internally, which are then used to calculate p-values and conduct the
Stouffer and Binomial test used for the <i>p</i>-curve analysis. Interpretations of the function
concerning the presence or absence/inadequateness of evidential value are made according to the
guidelines described by Simonsohn, Simmons and Nelson (2015):
</p>

<ul>
<li> <p><strong>Evidential value present</strong>: The right-skewness test is significant for the half curve with
<i>p&lt;0.05</i> <strong>or</strong> the <i>p</i>-value of the right-skewness test is <i>&lt;0.1</i> for both the half and full curve.
</p>
</li>
<li> <p><strong>Evidential value absent or inadequate</strong>: The flatness test is <i>p&lt;0.05</i> for the full curve
<strong>or</strong> the flatness test for the half curve and the binomial test are <i>p&lt;0.1</i>.
</p>
</li></ul>

<p>For effect size estimation, the <code>pcurve</code> function implements parts of the loss function
presented in Simonsohn, Simmons and Nelson (2014b).
The function generates a loss function for candidate effect sizes <i>\hat{d}</i>, using <i>D</i>-values in
a Kolmogorov-Smirnov test as the metric of fit, and the value of <i>\hat{d}</i> which minimizes <i>D</i>
as the estimated true effect.
</p>
<p>It is of note that a lack of robustness of <i>p</i>-curve analysis results
has been noted for meta-analyses with substantial heterogeneity (van Aert, Wicherts, &amp; van Assen, 2016).
Following van Aert et al., adjusted effect size estimates should only be
reported and interpreted for analyses with <i>I^2</i> values below 50 percent.
A warning message is therefore printed by
the <code>pcurve</code> function when <code>x</code> is of class <code>meta</code> and the between-study heterogeneity
of the meta-analysis is substantial (i.e., <i>I^2</i> greater than 50 percent).
</p>


<h3>Value</h3>

<p>Returns a plot and main results of the pcurve analysis:
</p>

<ul>
<li> <p><strong>P-curve plot</strong>: A plot displaying the observed <i>p</i>-curve and significance results
for the right-skewness and flatness test.
</p>
</li>
<li> <p><strong>Number of studies</strong>: The number of studies provided for the analysis, the number
of significant <i>p</i>-values included in the analysis, and the number of studies with <i>p&lt;0.025</i>
used for the half-curve tests.
</p>
</li>
<li> <p><strong>Test results</strong>: The results for the right-skewness and flatness test, including the
<i>p_{binomial}</i> value, as well as the <i>z</i> and <i>p</i> value for the full and half-curve test.
</p>
</li>
<li> <p><strong>Power Estimate</strong>: The power estimate and 95% confidence interval.
</p>
</li>
<li> <p><strong>Evidential value</strong>: Two lines displaying if evidential value is present and/or absent/inadequate based
on the results (using the guidelines by Simonsohn et al., 2015, see Details).
</p>
</li>
<li> <p><strong>True effect estimate</strong>: If <code>effect.estimation</code> is set to <code>TRUE</code>, the estimated true effect
<i>\hat{d}</i> is returned additionally.
</p>
</li></ul>

<p>If results are saved to a variable, a list of class <code>pcurve</code> containing the following objects is returned:
</p>

<ul>
<li> <p><code>pcurveResults</code>: A data frame containing the results for the right-skewness and flatness test, including the
<i>p_{binomial}</i> value, as well as the <i>z</i> and <i>p</i> value for the full and half-curve test.
</p>
</li>
<li> <p><code>Power</code>: The power estimate and 95% confidence interval.
</p>
</li>
<li> <p><code>PlotData</code>: A data frame with the data used in the <i>p</i>-curve plot.
</p>
</li>
<li> <p><code>Input</code>: A data frame containing the provided effect sizes, calculated <i>p</i>-values and individual results for each included (significant) effect.
</p>
</li>
<li> <p><code>EvidencePresent</code>, <code>EvidenceAbsent</code>, <code>kInput</code>, <code>kAnalyzed</code>, <code>kp0.25</code>: Further results of the <i>p</i>-curve analysis, including the presence/absence of evidence interpretation,
and number of provided/significant/<i>p&lt;0.025</i> studies.
</p>
</li>
<li> <p><code>I2</code>: <i>I^2</i>-Heterogeneity of the studies provided as input (only when <code>x</code> is of class <code>meta</code>).
</p>
</li>
<li> <p><code>class.meta.object</code>: <code>class</code> of the original object provided in <code>x</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Mathias Harrer &amp; David Daniel Ebert
</p>


<h3>References</h3>

<p>Harrer, M., Cuijpers, P., Furukawa, T.A, &amp; Ebert, D. D. (2019).
<em>Doing Meta-Analysis in R: A Hands-on Guide</em>. DOI: 10.5281/zenodo.2551803.
<a href="https://bookdown.org/MathiasHarrer/Doing_Meta_Analysis_in_R/pcurve.html">Chapter 9.2</a>.
</p>
<p>Simonsohn, U., Nelson, L. D., &amp; Simmons, J. P. (2014a). P-curve: a Key to the File-drawer.
<em>Journal of Experimental Psychology, 143</em>(2), 534.
</p>
<p>Simonsohn, U., Nelson, L. D. &amp; Simmons, J. P. (2014b). P-Curve and Effect Size:
Correcting for Publication Bias Using Only Significant Results.
<em>Perspectives on Psychological Science 9</em>(6), 666–81.
</p>
<p>Simonsohn, U., Nelson, L. D. &amp; Simmons, J. P. (2015). Better P-Curves: Making P-Curve
Analysis More Robust to Errors, Fraud, and Ambitious P-Hacking, a Reply to Ulrich and Miller (2015).
<em>Journal of Experimental Psychology, 144</em>(6), 1146-1152.
</p>
<p>Simonsohn, U. (2017). R code for the P-Curve App 4.052. http://p-curve.com/app4/pcurve_app4.052.r (Accessed 2019-08-16).
</p>
<p>Van Aert, R. C., Wicherts, J. M., &amp; van Assen, M. A. (2016).
Conducting meta-analyses based on p values: Reservations and recommendations for applying
<em>p</em>-uniform and <em>p</em>-curve. <em>Perspectives on Psychological Science, 11</em>(5), 713-729.
</p>


<h3>See Also</h3>

<p><code><a href="../../dmetar/help/eggers.test.html">eggers.test</a></code>
</p>


<h3>Examples</h3>

<pre>
# Example 1: Use metagen object, do not estimate d
suppressPackageStartupMessages(library(meta))
data("ThirdWave")
meta1 = metagen(TE,seTE, studlab=ThirdWave$Author, data=ThirdWave)
pcurve(meta1)

# Example 2: Provide Ns, calculate d estimate
N = c(105, 161, 60, 37, 141, 82, 97, 61, 200, 79, 124, 25, 166, 59, 201,  95, 166, 144)
pcurve(meta1, effect.estimation = TRUE, N = N)

# Example 3: Use metacont object, calculate d estimate
data("amlodipine")
meta2 &lt;- metacont(n.amlo, mean.amlo, sqrt(var.amlo),
                  n.plac, mean.plac, sqrt(var.plac),
                  data=amlodipine, studlab=study, sm="SMD")
N = amlodipine$n.amlo + amlodipine$n.plac
pcurve(meta2, effect.estimation = TRUE, N = N, dmin = 0, dmax = 1)

# Example 4: Construct x object from scratch
sim = data.frame("studlab" = c(paste("Study_", 1:18, sep = "")),
                   "TE" = c(0.561, 0.296, 0.648, 0.362, 0.770, 0.214, 0.476,
                            0.459, 0.343, 0.804, 0.357, 0.476, 0.638, 0.396, 0.497,
                            0.384, 0.568, 0.415),
                   "seTE" = c(0.338, 0.297, 0.264, 0.258, 0.279, 0.347, 0.271, 0.319,
                              0.232, 0.237, 0.385, 0.398, 0.342, 0.351, 0.296, 0.325,
                              0.322, 0.225))
pcurve(sim)
</pre>

<hr /><div style="text-align: center;">[Package <em>dmetar</em> version 0.0.9000 <a href="00Index.html">Index</a>]</div>
</div></body></html>
