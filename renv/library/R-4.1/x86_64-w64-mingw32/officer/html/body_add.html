<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Add content into a Word document</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table width="100%" summary="page for body_add {officer}"><tr><td>body_add {officer}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Add content into a Word document</h2>

<h3>Description</h3>

<p>This function add objects into a Word document. Values are added
as new paragraphs or tables.
</p>
<p>This function is experimental and will replace the <code style="white-space: pre;">body_add_*</code> functions
later. For now it is only to be used for successive additions and cannot
be used in conjunction with the <code style="white-space: pre;">body_add_*</code> functions.
</p>


<h3>Usage</h3>

<pre>
body_add(x, value, ...)

## S3 method for class 'character'
body_add(x, value, style = NULL, ...)

## S3 method for class 'numeric'
body_add(x, value, style = NULL, format_fun = formatC, ...)

## S3 method for class 'factor'
body_add(x, value, style = NULL, format_fun = as.character, ...)

## S3 method for class 'fpar'
body_add(x, value, style = NULL, ...)

## S3 method for class 'data.frame'
body_add(
  x,
  value,
  style = NULL,
  header = TRUE,
  tcf = table_conditional_formatting(),
  alignment = NULL,
  ...
)

## S3 method for class 'block_caption'
body_add(x, value, ...)

## S3 method for class 'block_list'
body_add(x, value, ...)

## S3 method for class 'block_toc'
body_add(x, value, ...)

## S3 method for class 'external_img'
body_add(x, value, style = "Normal", ...)

## S3 method for class 'run_pagebreak'
body_add(x, value, style = NULL, ...)

## S3 method for class 'run_columnbreak'
body_add(x, value, style = NULL, ...)

## S3 method for class 'gg'
body_add(
  x,
  value,
  width = 6,
  height = 5,
  res = 300,
  style = "Normal",
  scale = 1,
  ...
)

## S3 method for class 'plot_instr'
body_add(x, value, width = 6, height = 5, res = 300, style = "Normal", ...)

## S3 method for class 'block_pour_docx'
body_add(x, value, ...)

## S3 method for class 'block_section'
body_add(x, value, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>an rdocx object</p>
</td></tr>
<tr valign="top"><td><code>value</code></td>
<td>
<p>object to add in the document. Supported objects
are vectors, data.frame, graphics, block of formatted paragraphs,
unordered list of formatted paragraphs,
pretty tables with package flextable, 'Microsoft' charts with package mschart.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods. When
adding a <code>ggplot</code> object or <a href="../../officer/help/plot_instr.html">plot_instr</a>, these arguments will be used
by png function. See method signatures to see what arguments can be used.</p>
</td></tr>
<tr valign="top"><td><code>style</code></td>
<td>
<p>paragraph style name. These names are available with function <a href="../../officer/help/styles_info.html">styles_info</a>
and are the names of the Word styles defined in the base document (see
argument <code>path</code> from <a href="../../officer/help/read_docx.html">read_docx</a>).</p>
</td></tr>
<tr valign="top"><td><code>format_fun</code></td>
<td>
<p>a function to be used to format values.</p>
</td></tr>
<tr valign="top"><td><code>header</code></td>
<td>
<p>display header if TRUE</p>
</td></tr>
<tr valign="top"><td><code>tcf</code></td>
<td>
<p>conditional formatting settings defined by <code><a href="../../officer/help/table_conditional_formatting.html">table_conditional_formatting()</a></code></p>
</td></tr>
<tr valign="top"><td><code>alignment</code></td>
<td>
<p>columns alignement, argument length must match with columns length,
values must be &quot;l&quot; (left), &quot;r&quot; (right) or &quot;c&quot; (center).</p>
</td></tr>
<tr valign="top"><td><code>width</code></td>
<td>
<p>height in inches</p>
</td></tr>
<tr valign="top"><td><code>height</code></td>
<td>
<p>height in inches</p>
</td></tr>
<tr valign="top"><td><code>res</code></td>
<td>
<p>resolution of the png image in ppi</p>
</td></tr>
<tr valign="top"><td><code>scale</code></td>
<td>
<p>Multiplicative scaling factor, same as in ggsave</p>
</td></tr>
</table>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>character</code>: add a character vector.
</p>
</li>
<li> <p><code>numeric</code>: add a numeric vector.
</p>
</li>
<li> <p><code>factor</code>: add a factor vector.
</p>
</li>
<li> <p><code>fpar</code>: add a <a href="../../officer/help/fpar.html">fpar</a> object. These objects enable
the creation of formatted paragraphs made of formatted chunks of text.
</p>
</li>
<li> <p><code>data.frame</code>: add a data.frame object with <code><a href="../../officer/help/block_table.html">block_table()</a></code>.
</p>
</li>
<li> <p><code>block_caption</code>: add a <a href="../../officer/help/block_caption.html">block_caption</a> object. These objects enable
the creation of set of formatted paragraphs made of formatted chunks of text.
</p>
</li>
<li> <p><code>block_list</code>: add a <a href="../../officer/help/block_list.html">block_list</a> object.
</p>
</li>
<li> <p><code>block_toc</code>: add a table of content (a <a href="../../officer/help/block_toc.html">block_toc</a> object).
</p>
</li>
<li> <p><code>external_img</code>: add an image (a <a href="../../officer/help/external_img.html">external_img</a> object).
</p>
</li>
<li> <p><code>run_pagebreak</code>: add a <a href="../../officer/help/run_pagebreak.html">run_pagebreak</a> object.
</p>
</li>
<li> <p><code>run_columnbreak</code>: add a <a href="../../officer/help/run_columnbreak.html">run_columnbreak</a> object.
</p>
</li>
<li> <p><code>gg</code>: add a ggplot object.
</p>
</li>
<li> <p><code>plot_instr</code>: add a base plot with a <a href="../../officer/help/plot_instr.html">plot_instr</a> object.
</p>
</li>
<li> <p><code>block_pour_docx</code>: pour content of an external docx file with with a <a href="../../officer/help/block_pour_docx.html">block_pour_docx</a> object
</p>
</li>
<li> <p><code>block_section</code>: ends a section with a <a href="../../officer/help/block_section.html">block_section</a> object
</p>
</li></ul>


<h3>Illustrations</h3>

<p><img src="../help/figures/body_add_doc_1.png" width=70% />
</p>


<h3>Examples</h3>

<pre>
doc_1 &lt;- read_docx()
doc_1 &lt;- body_add(doc_1, "Table of content", style = "heading 1")
doc_1 &lt;- body_add(doc_1, block_toc())
doc_1 &lt;- body_add(doc_1, run_pagebreak())
doc_1 &lt;- body_add(doc_1, "A title", style = "heading 1")
doc_1 &lt;- body_add(doc_1, head(iris), style = "table_template")
doc_1 &lt;- body_add(doc_1, "Another title", style = "heading 1")
doc_1 &lt;- body_add(doc_1, letters, style = "Normal")
doc_1 &lt;- body_add(doc_1,
  block_section(prop_section(type = "continuous"))
)
doc_1 &lt;- body_add(doc_1, plot_instr(code = barplot(1:5, col = 2:6)))
doc_1 &lt;- body_add(doc_1,
  block_section(prop_section(page_size = page_size(orient = "landscape")))
)
print(doc_1, target = tempfile(fileext = ".docx"))
# print(doc_1, target = "test.docx")
</pre>

<hr /><div style="text-align: center;">[Package <em>officer</em> version 0.4.1 <a href="00Index.html">Index</a>]</div>
</div></body></html>
